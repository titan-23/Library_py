<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../style.css">
<title>Library_py-Graph-warshall_floyd</title>
</head>
<body>
<hr />
<h1><code>warshall_floyd</code></h1>
<hr />
<h2>コード</h2>
<p><a href="https://github.com/titanium-22/Library_py/blob/main/Graph/warshall_floyd.py"><code>warshall_floyd</code></a></p><button id="copyButton">コピー</button>
<script src="../copy.js"></script>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>

<span class="sd">&#39;&#39;&#39;Return min dist s.t. dist[a][b] -&gt; a to b. / O(|n|^3)&#39;&#39;&#39;</span>
<span class="k">def</span> <span class="nf">warshall_floyd</span><span class="p">(</span><span class="n">G</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]],</span> <span class="n">INF</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]]:</span>
  <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
  <span class="c1"># dist = [dijkstra(G, s, INF) for s in range(n)]</span>
  <span class="n">dist</span> <span class="o">=</span> <span class="p">[[</span><span class="n">INF</span><span class="p">]</span><span class="o">*</span><span class="n">n</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
  <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">G</span><span class="p">[</span><span class="n">v</span><span class="p">]:</span>
      <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
    <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">INF</span><span class="p">:</span> <span class="k">continue</span>
      <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dist</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]:</span>
          <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dist</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
        <span class="c1"># elif dist[i][j] == dist[i][k] + dist[k][j]:</span>
        <span class="c1">#   dist[i][j] = dist[i][k] + dist[k][j]</span>
<span class="w">  </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  for i in range(n):</span>
<span class="sd">    if dist[i][i] &lt; 0:</span>
<span class="sd">      return &#39;NEGATIVE CYCLE&#39;</span>
<span class="sd">  &#39;&#39;&#39;</span>
  <span class="k">return</span> <span class="n">dist</span>
</pre></div>

<hr />
<h2>仕様</h2>
<h4><code>warshall_floyd(G: List[List[Tuple[int, int]]]) -&gt; List[List[Union[int, float]]]</code></h4>
<ul>
<li>重み付き隣接リスト <code>G</code> に対し、全点対最短経路を返します。</li>
<li><code>O(N^3)</code> です。</li>
</ul>
<hr />
<h2>使用例</h2>
<p><code>python
n, m = int(input())
G = [[] for _ in range(n)]
for _ in range(m):
  # u -&gt; v の無向辺, 距離c
  u, v, c = map(int, input().split())
  G[u].append((u, v, c))
dist = warshall_floyd(G)  # dist[i][j]:= (i -&gt; j)の最短距離</code></p>
</body>
</html>
