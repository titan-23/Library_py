<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<p><link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet" type="text/css"></p>
<p><link rel="stylesheet" type="text/css" href="../../style.css"></p>
<script src="../../script.js"></script>
<p><title>Library_py-DataStructures-SplayTree-SplayTree</title>
</head></p>
<body>
<h3><a href="https://titanium-22.github.io/Library_py/">Home</a></h3>
<hr />
<hr />
<h1><a href="https://github.com/titanium-22/Library_py/blob/main/DataStructures/BBST/SplayTree"><code>SplayTree</code></a></h1>
<p>最終更新：2023/06/07
- READMEを修正しました。</p>
<p>splay操作をする木です。</p>
<hr />
<h1><a href="https://github.com/titanium-22/Library_py/blob/main/DataStructures/BBST/SplayTree/LazySplayTree.py"><code>LazySplayTree.py</code></a></h1>
<!-- code=https://github.com/titanium-22/Library_py/blob/main/DataStructures\SplayTree\SplayTree.py -->

<p>遅延伝播反転可能平衡二分木です。アホの定数倍をしています(定数倍が大きい方向にアホです)。</p>
<h2><code>LazySplayTreeData</code></h2>
<p>モノイドのデータや作用、左右の子などを保持するクラスです。 <code>LazySplayTree</code> をインスタンス化する際に渡してください。<br />
<code>merge / split</code> する場合はそれらが同一の <code>LazySplayTreeData</code> を持つ必要があります。</p>
<h2><code>LazySplayTree</code></h2>
<p>親へのポインタ持たせて～～</p>
<h4><code>st = LazySplayTree(data: LazySplayTreeData, n_or_a: Union[int, Iterable[T]]=0)</code></h4>
<ul>
<li><code>data</code> から <code>LazySplayTree</code> を構築します。</li>
<li><code>n_or_a</code> が <code>int</code> のとき、<code>data.e</code> から長さ <code>n</code> の <code>st</code> が作られます。
<code>n_or_a</code> が <code>Iterable</code> のとき、<code>a</code> から <code>st</code> が作られます。</li>
<li><code>O(N)</code> です。</li>
</ul>
<h4><code>st.merge(other: LazySplayTree) -&gt; None</code></h4>
<ul>
<li><code>st</code> の後ろに <code>other</code> を連結します。</li>
<li>償却 <code>O(logN)</code> です。</li>
</ul>
<h4><code>st.split(k: int) -&gt; Tuple[LazySplayTree, LazySplayTree]</code></h4>
<ul>
<li>2つの <code>LazySplayTree</code> を要素に持つタプルを返します。<ul>
<li>1要素目は <code>st</code> の <code>0</code> 番目から <code>k-1</code> 番目までを、2要素目は <code>k</code> 番目以降を要素に持ちます。</li>
</ul>
</li>
<li>償却 <code>O(logN)</code> です。</li>
</ul>
<h4><code>st.insert(k: int, key: T) -&gt; None</code></h4>
<ul>
<li>位置 <code>k</code> に <code>key</code> を挿入します。</li>
<li>償却 <code>O(logN)</code> です。</li>
</ul>
<h4><code>st.append(key: T) / .appendleft(key: T) -&gt; None</code></h4>
<ul>
<li>末尾 / 先頭 に <code>key</code> を追加します。</li>
<li>償却 <code>O(logN)</code> です。</li>
</ul>
<h4><code>st.pop(k: int=-1) / .popleft() -&gt; T</code></h4>
<ul>
<li><code>k</code> 番目 / 末尾 / 先頭 を削除しその値を返します。</li>
<li>償却 <code>O(logN)</code> です。</li>
</ul>
<h4><code>st[k] -&gt; T</code></h4>
<ul>
<li><code>k</code> 番目を返します。</li>
<li>償却 <code>O(logN)</code> です。</li>
</ul>
<h4><code>st[k] = key: T</code></h4>
<ul>
<li><code>k</code> 番目を <code>key</code> に更新します。</li>
<li>償却 <code>O(logN)</code> です。</li>
</ul>
<h4><code>st.copy() -&gt; LazySplayTree</code></h4>
<ul>
<li>コピーします。</li>
<li><code>O(N)</code> です。</li>
</ul>
<h4><code>st.reverse(l: int, r: int) -&gt; None</code></h4>
<ul>
<li>区間 <code>[l, r)</code> を反転します。 <code>reverse()</code> メソッドを一度でも使用するなら <code>op</code> には可換性が求められます(可換性がない場合、嘘の動作をします)。</li>
<li>償却 <code>O(logN)</code> です。</li>
</ul>
<h4><code>st.all_reverse() -&gt; None</code></h4>
<ul>
<li>区間 <code>[0, N)</code> を反転します。</li>
<li><code>O(1)</code> です。</li>
</ul>
<h4><code>st.apply(l: int, r: int, f: F) -&gt; None</code></h4>
<ul>
<li>区間 <code>[l, r)</code> に作用 <code>f</code> を適用します。</li>
<li>償却 <code>O(logN)</code> です。</li>
</ul>
<h4><code>st.all_apply(f: F) -&gt; None</code></h4>
<ul>
<li>区間 <code>[0, N)</code> に作用 <code>f</code> を適用します。</li>
<li><code>O(1)</code> です。</li>
</ul>
<h4><code>st.prod(l: int, r: int) -&gt; T</code></h4>
<ul>
<li>区間 <code>[l, r)</code> に <code>op</code> を適用した結果を返します。</li>
<li>償却 <code>O(logN)</code> です。</li>
</ul>
<h4><code>st.all_prod() -&gt; T</code></h4>
<ul>
<li>区間 <code>[0, N)</code> の総積を返します。</li>
<li><code>O(1)</code> です。</li>
</ul>
<h4><code>st.tolist() -&gt; List[T]</code></h4>
<ul>
<li><code>List</code> に変換します。非再帰です。</li>
<li><code>O(N)</code> です。</li>
</ul>
<h4><code>iter(st) / next(st) / len(st) / str(st) / repr(st)</code></h4>
<h2>使用例</h2>
<div class="code-block">
<div class="highlight" id="codeContainer1"><pre><span></span><span class="n">op</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">s</span> <span class="o">+</span> <span class="n">t</span>
<span class="n">mapping</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">f</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="n">f</span>
<span class="n">composition</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">:</span> <span class="n">f</span>
<span class="n">e</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nb">id</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">LazySplayTreeData</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">mapping</span><span class="p">,</span> <span class="n">composition</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>

<span class="n">n</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span class="n">A</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
<span class="n">splay</span> <span class="o">=</span> <span class="n">LazySplayTree</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
  <span class="n">qu</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
  <span class="k">if</span>
</pre></div>

</div>

<p></body>
</html></p>
